{% capture currentform %}{{ include.form }}{% endcapture %}

{% for page in site.data[currentform] %}

  {% assign fields = page.fields %}
  {% assign label = page.title %}

  <div class="form-section"{% if page.group %} data-group="{{ page.group }}"{% endif %}>

    {% comment %} Page headers {% endcomment %}
    <header class="hero-banner default">
      <h1>
        {{ label | markdownify | remove: '<p>' | remove: '</p>' }}
      </h1>
      {% if page.description %}
        {{ page.description | markdownify | improve }}
      {% endif %}
    </header>

    <div class="form-content">
      <div class="form-content-inner">

        <div class="nav-on-top">
          {% include pagination.html %}
        </div>
        {% comment %} Render fields in the page {% endcomment %}
        {% include render_field.html %}

        {% include pagination.html %}
      </div>
    </div>

  </div>
{% endfor %}

<div class="form-section form-section-preview">

  <header class="hero-banner default">
    <h1>Preview</h1>
  </header>

  <div class="form-content">
    <div class="form-content-inner">

    <div class="nav-on-top">
      {% include pagination.html preview=true %}
    </div>

    <dl>
    {% for page in site.data[currentform] %}
      {% for field in page.fields %}
        {% unless field.type == 'link' or field.type == 'paragraph' or field.type == 'header' %}
          {% capture name %}{{ field.label | slugify }}-field-{{ forloop.index }}{% endcapture %}

          <dt>{{ field.label }}</dt>
          <dd id="preview-{{ name }}"></dd>
        {% endunless %}
      {% endfor %}
    {% endfor %}
    </dl>

    {% include pagination.html preview=true %}
    </div>
  </div>
</div>